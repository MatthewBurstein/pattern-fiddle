!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3);t.squareStates=[r.SquareState.LIGHT,r.SquareState.TRANSITION_FROM_LIGHT,r.SquareState.TRANSITION_TO_DARK,r.SquareState.DARK,r.SquareState.TRANSITION_FROM_DARK,r.SquareState.TRANSITION_TO_LIGHT],t.width=window.innerWidth,t.height=window.innerHeight,t.numberOfColumns=12,t.dimension=t.width/t.numberOfColumns,t.canvas=document.getElementById("canvas"),t.canvas.width=t.width,t.canvas.height=t.height,t.numberOfRows=Math.ceil(t.height/t.dimension),t.interval=5.5},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(0),a={offset:0,squares:Array(i.numberOfColumns).fill(void 0).map((function(e,t){return Array(i.numberOfRows).fill(void 0).map((function(e,n){return{colorIndex:o(t,n),squareState:i.squareStates[0],locked:!1,overlayWidth:i.dimension}}))}))};function o(e,t){return e%2==0?t%2==0?0:1:t%2==0?2:3}function u(e){var t=(i.squareStates.findIndex((function(t){return t===e.squareState}))+1)%i.squareStates.length;e.squareState=i.squareStates[t],e.locked=r.isTransitionState(e)}t.getGlobalState=function(){return a},t.moveSquares=function(e){var t;!function(e){a.offset=e}((e.offset+1)%i.width),t=a.squares.map((function(e){return e.map((function(e){return r.isTransitionFromState(e)?function(e){return e.overlayWidth>0?e.overlayWidth--:u(e),e}(e):r.isTransitionToState(e)?function(e){return e.overlayWidth<i.dimension?e.overlayWidth++:u(e),e}(e):e}))})),a.squares=t},t.handleMouseMove=function(e,t){var n=function(e,t,n){var r=e-n,a=r>=0?r:r+i.width,o=Math.floor(a/i.dimension),u=Math.floor(t/i.dimension);return[o,u]}(e,t,a.offset),r=n[0],o=n[1],s=a.squares[r][o];s.locked||u(s)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3);t.isTransitionState=function(e){return[r.SquareState.TRANSITION_FROM_DARK,r.SquareState.TRANSITION_FROM_LIGHT,r.SquareState.TRANSITION_TO_LIGHT,r.SquareState.TRANSITION_TO_DARK].includes(e.squareState)},t.isTransitionFromState=function(e){return[r.SquareState.TRANSITION_FROM_DARK,r.SquareState.TRANSITION_FROM_LIGHT].includes(e.squareState)},t.isTransitionToState=function(e){return[r.SquareState.TRANSITION_TO_LIGHT,r.SquareState.TRANSITION_TO_DARK].includes(e.squareState)},t.hasLightPrimaryPalette=function(e){return[r.SquareState.LIGHT,r.SquareState.TRANSITION_FROM_LIGHT,r.SquareState.TRANSITION_TO_LIGHT].includes(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.LIGHT="light",e.TRANSITION_FROM_LIGHT="transitionFromLight",e.TRANSITION_TO_DARK="transitionToDark",e.DARK="dark",e.TRANSITION_FROM_DARK="transitionFromDark",e.TRANSITION_TO_LIGHT="transitionToLight"}(t.SquareState||(t.SquareState={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(5)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);n(6).startSquareAnimation(),window.addEventListener("mousemove",(function(e){var t=e.clientX,n=e.clientY;r.handleMouseMove(t,n)})),window.addEventListener("touchstart",(function(e){var t=e.touches[0],n=t.pageX,i=t.pageY;r.handleMouseMove(n,i)})),window.addEventListener("touchmove",(function(e){var t=e.touches[0],n=t.pageX,i=t.pageY;r.handleMouseMove(n,i)}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(0),a=n(7),o=n(1),u=r.canvas.getContext("2d");function s(e){u.clearRect(0,0,i.width,i.height);var t=e.squares,n=e.offset;return t.map((function(e,t){var r=n+t*i.dimension,a=r-(r>=i.width?i.width:0),o=a>i.width-i.dimension;return e.map((function(e,t){return o?function(e,t,n){var r=e.colorIndex,a=e.overlayWidth,o=e.squareState,u=n*i.dimension,s=i.dimension/2-a/2,d=t+s;l(t,u,i.dimension,r),c(d,u,a,r,o);var f=(i.dimension-(i.width-t))%i.width;l(0,u,f,r);var S=i.dimension-f,T=i.dimension/2-a/2,v=f>T;c(v?s-S:0,u,v?a:a-S,r,o)}(e,r,t):function(e,t,n){var r=e.colorIndex,a=e.overlayWidth,o=n*i.dimension,u=t+i.dimension/2-a/2;l(t,o,i.dimension,r),c(u,o,a,e.colorIndex,e.squareState)}(e,a,t),e}))})),e}function c(e,t,n,r,o){u.globalAlpha=.95,u.fillStyle=function(e,t){return a.getOverlayPalette(t,e)}(r,o),u.fillRect(e,t,n,i.dimension)}function l(e,t,n,r){u.globalAlpha=1,u.fillStyle=a.getBaseColor(r),u.fillRect(e,t,n,i.dimension)}t.paint=s,t.startSquareAnimation=function(){var e=o.getGlobalState();!function t(){setTimeout((function(){s(e),o.moveSquares(e),t()}),i.interval)}()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=Object.freeze(["#EAE8E3","#C9C3C1","#C2C1C9","#FFFCF2"]),a=Object.freeze(["#EAE0CC","#C9ADA1","#ADA7C9","#FFF3BB"]),o=Object.freeze(["#84775E","#7C3A2A","#492A91","#D8C158"]);t.getOverlayPalette=function(e,t){return(r.hasLightPrimaryPalette(e)?a:o)[t]},t.getBaseColor=function(e){return i[e]}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbnN0YW50cy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvc3RhdGUudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3NxdWFyZS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvdHlwZXMudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LnRzIiwid2VicGFjazovLy8uL3NyYy9ydW4udHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NhbnZhcy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvY29sb3JzLnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwic3F1YXJlU3RhdGVzIiwiU3F1YXJlU3RhdGUiLCJMSUdIVCIsIlRSQU5TSVRJT05fRlJPTV9MSUdIVCIsIlRSQU5TSVRJT05fVE9fREFSSyIsIkRBUksiLCJUUkFOU0lUSU9OX0ZST01fREFSSyIsIlRSQU5TSVRJT05fVE9fTElHSFQiLCJ3aWR0aCIsIndpbmRvdyIsImlubmVyV2lkdGgiLCJoZWlnaHQiLCJpbm5lckhlaWdodCIsIm51bWJlck9mQ29sdW1ucyIsImRpbWVuc2lvbiIsImNhbnZhcyIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJudW1iZXJPZlJvd3MiLCJNYXRoIiwiY2VpbCIsImludGVydmFsIiwiZ2xvYmFsU3RhdGUiLCJvZmZzZXQiLCJzcXVhcmVzIiwiQXJyYXkiLCJmaWxsIiwidW5kZWZpbmVkIiwibWFwIiwiXyIsInhJZHgiLCJ5SWR4IiwiY29sb3JJbmRleCIsImdldENvbG9ySW5kZXgiLCJzcXVhcmVTdGF0ZSIsImxvY2tlZCIsIm92ZXJsYXlXaWR0aCIsIm1vdmVTcXVhcmVUb05leHRTdGF0ZSIsInNxdWFyZSIsIm5ld1N0YXRlSWR4IiwiZmluZEluZGV4IiwibGVuZ3RoIiwiaXNUcmFuc2l0aW9uU3RhdGUiLCJzdGF0ZSIsIm5ld1NxdWFyZXMiLCJ1cGRhdGVPZmZzZXQiLCJyb3ciLCJpc1RyYW5zaXRpb25Gcm9tU3RhdGUiLCJkZWNyZW1lbnRPdmVybGF5V2lkdGhPck1vdmVTdGF0ZSIsImlzVHJhbnNpdGlvblRvU3RhdGUiLCJpbmNyZW1lbnRPdmVybGF5V2lkdGhPck1vdmVTdGF0ZSIsInhDb29yZCIsInlDb29yZCIsIm5hdHVyYWxYUG9zaXRpb24iLCJyZWFsWFBvc2l0aW9uIiwiZmxvb3IiLCJjb2wiLCJpbmNsdWRlcyIsInN0YXJ0U3F1YXJlQW5pbWF0aW9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwiY2xpZW50WCIsImNsaWVudFkiLCJoYW5kbGVNb3VzZU1vdmUiLCJwYWdlWCIsInBhZ2VZIiwiY3R4IiwiZ2V0Q29udGV4dCIsInBhaW50IiwiY2xlYXJSZWN0IiwiaXNTcGxpdENvbHVtbiIsIm5hdHVyYWxMZWZ0RWRnZU9mT3ZlcmxheSIsIm92ZXJsYXlSaWdodFhDb29yZCIsInBhaW50QmFzZVNxdWFyZSIsInBhaW50T3ZlcmxheSIsImxlZnRSZWN0V2lkdGgiLCJyaWdodFJlY3RXaWR0aCIsImRpc3RhbmNlQmV0d2VlblJlY3RFZGdlYW5kUmlnaHRFZGdlT2ZPdmVybGF5IiwiaXNFbnRpcmVPdmVybGF5T25MZWZ0UmVjdCIsInBhaW50U3BsaXRTcXVhcmUiLCJwYWludFdob2xlU3F1YXJlIiwiZ2xvYmFsQWxwaGEiLCJmaWxsU3R5bGUiLCJnZXRPdmVybGF5UGFsZXR0ZSIsImdldE92ZXJsYXlDb2xvciIsImZpbGxSZWN0IiwiZ2V0QmFzZUNvbG9yIiwiZ2V0R2xvYmFsU3RhdGUiLCJyZWN1cnNpdmVseUFuaW1hdGVTcXVhcmVzIiwic2V0VGltZW91dCIsIm1vdmVTcXVhcmVzIiwiYmFzZUNvbG9ycyIsImZyZWV6ZSIsImxpZ2h0Q29sb3JzIiwiZGFya0NvbG9ycyIsImhhc0xpZ2h0UHJpbWFyeVBhbGV0dGUiLCJpbmRleCJdLCJtYXBwaW5ncyI6ImFBQ0UsSUFBSUEsRUFBbUIsR0FHdkIsU0FBU0MsRUFBb0JDLEdBRzVCLEdBQUdGLEVBQWlCRSxHQUNuQixPQUFPRixFQUFpQkUsR0FBVUMsUUFHbkMsSUFBSUMsRUFBU0osRUFBaUJFLEdBQVksQ0FDekNHLEVBQUdILEVBQ0hJLEdBQUcsRUFDSEgsUUFBUyxJQVVWLE9BTkFJLEVBQVFMLEdBQVVNLEtBQUtKLEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVNGLEdBRy9ERyxFQUFPRSxHQUFJLEVBR0pGLEVBQU9ELFFBS2ZGLEVBQW9CUSxFQUFJRixFQUd4Qk4sRUFBb0JTLEVBQUlWLEVBR3hCQyxFQUFvQlUsRUFBSSxTQUFTUixFQUFTUyxFQUFNQyxHQUMzQ1osRUFBb0JhLEVBQUVYLEVBQVNTLElBQ2xDRyxPQUFPQyxlQUFlYixFQUFTUyxFQUFNLENBQUVLLFlBQVksRUFBTUMsSUFBS0wsS0FLaEVaLEVBQW9Ca0IsRUFBSSxTQUFTaEIsR0FDWCxvQkFBWGlCLFFBQTBCQSxPQUFPQyxhQUMxQ04sT0FBT0MsZUFBZWIsRUFBU2lCLE9BQU9DLFlBQWEsQ0FBRUMsTUFBTyxXQUU3RFAsT0FBT0MsZUFBZWIsRUFBUyxhQUFjLENBQUVtQixPQUFPLEtBUXZEckIsRUFBb0JzQixFQUFJLFNBQVNELEVBQU9FLEdBRXZDLEdBRFUsRUFBUEEsSUFBVUYsRUFBUXJCLEVBQW9CcUIsSUFDL0IsRUFBUEUsRUFBVSxPQUFPRixFQUNwQixHQUFXLEVBQVBFLEdBQThCLGlCQUFWRixHQUFzQkEsR0FBU0EsRUFBTUcs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RUFBQU0sV0EvRnRDLFVBa0dBLGtDQUNFLElBQU02QixFQUFRLEVBQUE0QyxrQkFDZCxTQUFTQyxJQUNQQyxZQUFXLFdBQ1RyQixFQUFNekIsR0FDTixFQUFBK0MsWUFBWS9DLEdBQ1o2QyxNQUNDLEVBQUFuRSxVQUdMbUUsSyw4RUNuSEYsV0FFTUcsRUFBYWpILE9BQU9rSCxPQUFPLENBQUMsVUFBVyxVQUFXLFVBQVcsWUFDN0RDLEVBQWNuSCxPQUFPa0gsT0FBTyxDQUFDLFVBQVcsVUFBVyxVQUFXLFlBQzlERSxFQUFhcEgsT0FBT2tILE9BQU8sQ0FBQyxVQUFXLFVBQVcsVUFBVyxZQU1uRSw2QkFDRTFELEVBQ0FGLEdBRUEsT0FBUSxFQUFBK0QsdUJBQXVCN0QsR0FBZTJELEVBQWNDLEdBQzFEOUQsSUFJSix3QkFBNkJnRSxHQUMzQixPQUFPTCxFQUFXSyIsImZpbGUiOiJidW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gNCk7XG4iLCJpbXBvcnQgeyBTcXVhcmVTdGF0ZSB9IGZyb20gJy4vdHlwZXMnO1xuXG5leHBvcnQgY29uc3Qgc3F1YXJlU3RhdGVzOiBTcXVhcmVTdGF0ZVtdID0gW1xuICBTcXVhcmVTdGF0ZS5MSUdIVCxcbiAgU3F1YXJlU3RhdGUuVFJBTlNJVElPTl9GUk9NX0xJR0hULFxuICBTcXVhcmVTdGF0ZS5UUkFOU0lUSU9OX1RPX0RBUkssXG4gIFNxdWFyZVN0YXRlLkRBUkssXG4gIFNxdWFyZVN0YXRlLlRSQU5TSVRJT05fRlJPTV9EQVJLLFxuICBTcXVhcmVTdGF0ZS5UUkFOU0lUSU9OX1RPX0xJR0hUXG5dO1xuXG5leHBvcnQgY29uc3Qgd2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcbmV4cG9ydCBjb25zdCBoZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XG5leHBvcnQgY29uc3QgbnVtYmVyT2ZDb2x1bW5zID0gMTI7XG5cbmV4cG9ydCBjb25zdCBkaW1lbnNpb24gPSB3aWR0aCAvIG51bWJlck9mQ29sdW1ucztcblxuZXhwb3J0IGNvbnN0IGNhbnZhcyA9IDxIVE1MQ2FudmFzRWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FudmFzJyk7XG5jYW52YXMud2lkdGggPSB3aWR0aDtcbmNhbnZhcy5oZWlnaHQgPSBoZWlnaHQ7XG5leHBvcnQgY29uc3QgbnVtYmVyT2ZSb3dzID0gTWF0aC5jZWlsKGhlaWdodCAvIGRpbWVuc2lvbik7XG5cbmV4cG9ydCBjb25zdCBpbnRlcnZhbCA9IDUuNTtcbiIsImltcG9ydCB7IFN0YXRlLCBTcXVhcmUgfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7XG4gIGlzVHJhbnNpdGlvbkZyb21TdGF0ZSxcbiAgaXNUcmFuc2l0aW9uVG9TdGF0ZSxcbiAgaXNUcmFuc2l0aW9uU3RhdGVcbn0gZnJvbSAnLi9zcXVhcmUnO1xuaW1wb3J0IHtcbiAgZGltZW5zaW9uLFxuICBzcXVhcmVTdGF0ZXMsXG4gIHdpZHRoLFxuICBudW1iZXJPZlJvd3MsXG4gIG51bWJlck9mQ29sdW1uc1xufSBmcm9tICcuL2NvbnN0YW50cyc7XG5cbmNvbnN0IGdsb2JhbFN0YXRlOiBTdGF0ZSA9IHtcbiAgb2Zmc2V0OiAwLFxuICBzcXVhcmVzOiBnZXRJbml0aWFsU3F1YXJlcygpXG59O1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0R2xvYmFsU3RhdGUoKTogU3RhdGUge1xuICByZXR1cm4gZ2xvYmFsU3RhdGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtb3ZlU3F1YXJlcyhzdGF0ZTogU3RhdGUpOiB2b2lkIHtcbiAgY29uc3QgeyBvZmZzZXQgfSA9IHN0YXRlO1xuICB1cGRhdGVPZmZzZXQoKG9mZnNldCArIDEpICUgd2lkdGgpO1xuICB1cGRhdGVPdmVybGF5V2lkdGhzQW5kU3F1YXJlU3RhdGVzKCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBoYW5kbGVNb3VzZU1vdmUoeENvb3JkOiBudW1iZXIsIHlDb29yZDogbnVtYmVyKTogdm9pZCB7XG4gIGNvbnN0IFtyb3csIGNvbF0gPSBnZXRDdXJyZW50U3F1YXJlRnJvbUNvb3JkcyhcbiAgICB4Q29vcmQsXG4gICAgeUNvb3JkLFxuICAgIGdsb2JhbFN0YXRlLm9mZnNldFxuICApO1xuICBjb25zdCBzcXVhcmUgPSBnbG9iYWxTdGF0ZS5zcXVhcmVzW3Jvd11bY29sXTtcbiAgaWYgKCFzcXVhcmUubG9ja2VkKSB7XG4gICAgbW92ZVNxdWFyZVRvTmV4dFN0YXRlKHNxdWFyZSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gdXBkYXRlT2Zmc2V0KG9mZnNldDogbnVtYmVyKTogU3RhdGUge1xuICBnbG9iYWxTdGF0ZS5vZmZzZXQgPSBvZmZzZXQ7XG4gIHJldHVybiBnbG9iYWxTdGF0ZTtcbn1cblxuZnVuY3Rpb24gdXBkYXRlU3F1YXJlcyhuZXdTcXVhcmVzOiBTcXVhcmVbXVtdKSB7XG4gIGdsb2JhbFN0YXRlLnNxdWFyZXMgPSBuZXdTcXVhcmVzO1xuICByZXR1cm4gZ2xvYmFsU3RhdGU7XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZU92ZXJsYXlXaWR0aHNBbmRTcXVhcmVTdGF0ZXMoKTogU3RhdGUge1xuICByZXR1cm4gdXBkYXRlU3F1YXJlcyhcbiAgICBnbG9iYWxTdGF0ZS5zcXVhcmVzLm1hcCgocm93OiBTcXVhcmVbXSk6IFNxdWFyZVtdID0+XG4gICAgICByb3cubWFwKFxuICAgICAgICAoc3F1YXJlOiBTcXVhcmUpOiBTcXVhcmUgPT4ge1xuICAgICAgICAgIGlmIChpc1RyYW5zaXRpb25Gcm9tU3RhdGUoc3F1YXJlKSkge1xuICAgICAgICAgICAgcmV0dXJuIGRlY3JlbWVudE92ZXJsYXlXaWR0aE9yTW92ZVN0YXRlKHNxdWFyZSk7XG4gICAgICAgICAgfSBlbHNlIGlmIChpc1RyYW5zaXRpb25Ub1N0YXRlKHNxdWFyZSkpIHtcbiAgICAgICAgICAgIHJldHVybiBpbmNyZW1lbnRPdmVybGF5V2lkdGhPck1vdmVTdGF0ZShzcXVhcmUpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gc3F1YXJlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKVxuICAgIClcbiAgKTtcbn1cblxuZnVuY3Rpb24gZ2V0SW5pdGlhbFNxdWFyZXMoKTogU3F1YXJlW11bXSB7XG4gIGNvbnN0IG91dHB1dCA9IEFycmF5KG51bWJlck9mQ29sdW1ucylcbiAgICAuZmlsbCh1bmRlZmluZWQpXG4gICAgLm1hcCgoXywgeElkeCkgPT4ge1xuICAgICAgcmV0dXJuIEFycmF5KG51bWJlck9mUm93cylcbiAgICAgICAgLmZpbGwodW5kZWZpbmVkKVxuICAgICAgICAubWFwKChfLCB5SWR4KSA9PiB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNvbG9ySW5kZXg6IGdldENvbG9ySW5kZXgoeElkeCwgeUlkeCksXG4gICAgICAgICAgICBzcXVhcmVTdGF0ZTogc3F1YXJlU3RhdGVzWzBdLFxuICAgICAgICAgICAgbG9ja2VkOiBmYWxzZSxcbiAgICAgICAgICAgIG92ZXJsYXlXaWR0aDogZGltZW5zaW9uXG4gICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gIHJldHVybiBvdXRwdXQ7XG59XG5cbmZ1bmN0aW9uIGdldENvbG9ySW5kZXgoeElkeDogbnVtYmVyLCB5SWR4OiBudW1iZXIpOiBudW1iZXIge1xuICBpZiAoeElkeCAlIDIgPT09IDApIHtcbiAgICByZXR1cm4geUlkeCAlIDIgPT09IDAgPyAwIDogMTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4geUlkeCAlIDIgPT09IDAgPyAyIDogMztcbiAgfVxufVxuXG5mdW5jdGlvbiBnZXRDdXJyZW50U3F1YXJlRnJvbUNvb3JkcyhcbiAgeENvb3JkOiBudW1iZXIsXG4gIHlDb29yZDogbnVtYmVyLFxuICBvZmZzZXQ6IG51bWJlclxuKTogW251bWJlciwgbnVtYmVyXSB7XG4gIGNvbnN0IG5hdHVyYWxYUG9zaXRpb24gPSB4Q29vcmQgLSBvZmZzZXQ7XG4gIGNvbnN0IHJlYWxYUG9zaXRpb24gPVxuICAgIG5hdHVyYWxYUG9zaXRpb24gPj0gMCA/IG5hdHVyYWxYUG9zaXRpb24gOiBuYXR1cmFsWFBvc2l0aW9uICsgd2lkdGg7XG4gIGNvbnN0IHJvdyA9IE1hdGguZmxvb3IocmVhbFhQb3NpdGlvbiAvIGRpbWVuc2lvbik7XG4gIGNvbnN0IGNvbCA9IE1hdGguZmxvb3IoeUNvb3JkIC8gZGltZW5zaW9uKTtcbiAgcmV0dXJuIFtyb3csIGNvbF07XG59XG5cbmZ1bmN0aW9uIG1vdmVTcXVhcmVUb05leHRTdGF0ZShzcXVhcmU6IFNxdWFyZSk6IHZvaWQge1xuICBjb25zdCBvbGRTdGF0ZUlkeCA9IHNxdWFyZVN0YXRlcy5maW5kSW5kZXgocyA9PiBzID09PSBzcXVhcmUuc3F1YXJlU3RhdGUpO1xuICBjb25zdCBuZXdTdGF0ZUlkeCA9IChvbGRTdGF0ZUlkeCArIDEpICUgc3F1YXJlU3RhdGVzLmxlbmd0aDtcbiAgc3F1YXJlLnNxdWFyZVN0YXRlID0gc3F1YXJlU3RhdGVzW25ld1N0YXRlSWR4XTtcbiAgc3F1YXJlLmxvY2tlZCA9IGlzVHJhbnNpdGlvblN0YXRlKHNxdWFyZSk7XG59XG5cbmZ1bmN0aW9uIGluY3JlbWVudE92ZXJsYXlXaWR0aE9yTW92ZVN0YXRlKHNxdWFyZTogU3F1YXJlKTogU3F1YXJlIHtcbiAgc3F1YXJlLm92ZXJsYXlXaWR0aCA8IGRpbWVuc2lvblxuICAgID8gc3F1YXJlLm92ZXJsYXlXaWR0aCsrXG4gICAgOiBtb3ZlU3F1YXJlVG9OZXh0U3RhdGUoc3F1YXJlKTtcbiAgcmV0dXJuIHNxdWFyZTtcbn1cbmZ1bmN0aW9uIGRlY3JlbWVudE92ZXJsYXlXaWR0aE9yTW92ZVN0YXRlKHNxdWFyZTogU3F1YXJlKTogU3F1YXJlIHtcbiAgc3F1YXJlLm92ZXJsYXlXaWR0aCA+IDBcbiAgICA/IHNxdWFyZS5vdmVybGF5V2lkdGgtLVxuICAgIDogbW92ZVNxdWFyZVRvTmV4dFN0YXRlKHNxdWFyZSk7XG4gIHJldHVybiBzcXVhcmU7XG59XG4iLCJpbXBvcnQgeyBTcXVhcmUsIFNxdWFyZVN0YXRlIH0gZnJvbSAnLi90eXBlcyc7XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1RyYW5zaXRpb25TdGF0ZShzcXVhcmU6IFNxdWFyZSk6IGJvb2xlYW4ge1xuICByZXR1cm4gW1xuICAgIFNxdWFyZVN0YXRlLlRSQU5TSVRJT05fRlJPTV9EQVJLLFxuICAgIFNxdWFyZVN0YXRlLlRSQU5TSVRJT05fRlJPTV9MSUdIVCxcbiAgICBTcXVhcmVTdGF0ZS5UUkFOU0lUSU9OX1RPX0xJR0hULFxuICAgIFNxdWFyZVN0YXRlLlRSQU5TSVRJT05fVE9fREFSS1xuICBdLmluY2x1ZGVzKHNxdWFyZS5zcXVhcmVTdGF0ZSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1RyYW5zaXRpb25Gcm9tU3RhdGUoc3F1YXJlOiBTcXVhcmUpOiBib29sZWFuIHtcbiAgcmV0dXJuIFtcbiAgICBTcXVhcmVTdGF0ZS5UUkFOU0lUSU9OX0ZST01fREFSSyxcbiAgICBTcXVhcmVTdGF0ZS5UUkFOU0lUSU9OX0ZST01fTElHSFRcbiAgXS5pbmNsdWRlcyhzcXVhcmUuc3F1YXJlU3RhdGUpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNUcmFuc2l0aW9uVG9TdGF0ZShzcXVhcmU6IFNxdWFyZSk6IGJvb2xlYW4ge1xuICByZXR1cm4gW1xuICAgIFNxdWFyZVN0YXRlLlRSQU5TSVRJT05fVE9fTElHSFQsXG4gICAgU3F1YXJlU3RhdGUuVFJBTlNJVElPTl9UT19EQVJLXG4gIF0uaW5jbHVkZXMoc3F1YXJlLnNxdWFyZVN0YXRlKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGhhc0xpZ2h0UHJpbWFyeVBhbGV0dGUoc3F1YXJlU3RhdGU6IFNxdWFyZVN0YXRlKSB7XG4gIHJldHVybiBbXG4gICAgU3F1YXJlU3RhdGUuTElHSFQsXG4gICAgU3F1YXJlU3RhdGUuVFJBTlNJVElPTl9GUk9NX0xJR0hULFxuICAgIFNxdWFyZVN0YXRlLlRSQU5TSVRJT05fVE9fTElHSFRcbiAgXS5pbmNsdWRlcyhzcXVhcmVTdGF0ZSk7XG59XG4iLCJleHBvcnQgaW50ZXJmYWNlIFN0YXRlIHtcbiAgb2Zmc2V0OiBudW1iZXI7XG4gIHNxdWFyZXM6IFNxdWFyZVtdW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3F1YXJlIHtcbiAgY29sb3JJbmRleDogbnVtYmVyO1xuICBzcXVhcmVTdGF0ZTogU3F1YXJlU3RhdGU7XG4gIGxvY2tlZDogYm9vbGVhbjtcbiAgb3ZlcmxheVdpZHRoOiBudW1iZXI7XG59XG5cbmV4cG9ydCBlbnVtIFNxdWFyZVN0YXRlIHtcbiAgTElHSFQgPSAnbGlnaHQnLFxuICBUUkFOU0lUSU9OX0ZST01fTElHSFQgPSAndHJhbnNpdGlvbkZyb21MaWdodCcsXG4gIFRSQU5TSVRJT05fVE9fREFSSyA9ICd0cmFuc2l0aW9uVG9EYXJrJyxcbiAgREFSSyA9ICdkYXJrJyxcbiAgVFJBTlNJVElPTl9GUk9NX0RBUksgPSAndHJhbnNpdGlvbkZyb21EYXJrJyxcbiAgVFJBTlNJVElPTl9UT19MSUdIVCA9ICd0cmFuc2l0aW9uVG9MaWdodCdcbn1cbiIsImltcG9ydCAnLi9ydW4nO1xuIiwiaW1wb3J0IHsgaGFuZGxlTW91c2VNb3ZlIH0gZnJvbSAnLi9zdGF0ZSc7XG5pbXBvcnQgeyBzdGFydFNxdWFyZUFuaW1hdGlvbiB9IGZyb20gJy4vY2FudmFzJztcblxuc3RhcnRTcXVhcmVBbmltYXRpb24oKTtcblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIGV2ZW50ID0+IHtcbiAgY29uc3QgeyBjbGllbnRYLCBjbGllbnRZIH0gPSBldmVudDtcbiAgaGFuZGxlTW91c2VNb3ZlKGNsaWVudFgsIGNsaWVudFkpO1xufSk7XG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgZXZlbnQgPT4ge1xuICBjb25zdCB7IHBhZ2VYLCBwYWdlWSB9ID0gZXZlbnQudG91Y2hlc1swXTtcbiAgaGFuZGxlTW91c2VNb3ZlKHBhZ2VYLCBwYWdlWSk7XG59KTtcblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIGV2ZW50ID0+IHtcbiAgY29uc3QgeyBwYWdlWCwgcGFnZVkgfSA9IGV2ZW50LnRvdWNoZXNbMF07XG4gIGhhbmRsZU1vdXNlTW92ZShwYWdlWCwgcGFnZVkpO1xufSk7XG4iLCJpbXBvcnQgeyBTdGF0ZSwgU3F1YXJlLCBTcXVhcmVTdGF0ZSB9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHsgY2FudmFzIH0gZnJvbSAnLi9jb25zdGFudHMnO1xuaW1wb3J0IHsgd2lkdGgsIGhlaWdodCwgZGltZW5zaW9uLCBpbnRlcnZhbCB9IGZyb20gJy4vY29uc3RhbnRzJztcbmltcG9ydCB7IGdldE92ZXJsYXlQYWxldHRlLCBPdmVybGF5Q29sb3IsIGdldEJhc2VDb2xvciB9IGZyb20gJy4vY29sb3JzJztcbmltcG9ydCB7IGdldEdsb2JhbFN0YXRlLCBtb3ZlU3F1YXJlcyB9IGZyb20gJy4vc3RhdGUnO1xuXG5jb25zdCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcblxuZXhwb3J0IGZ1bmN0aW9uIHBhaW50KHN0YXRlOiBTdGF0ZSk6IFN0YXRlIHtcbiAgY3R4LmNsZWFyUmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcbiAgY29uc3QgeyBzcXVhcmVzLCBvZmZzZXQgfSA9IHN0YXRlO1xuICBzcXVhcmVzLm1hcCgocm93LCB4SWR4KSA9PiB7XG4gICAgY29uc3QgbmF0dXJhbFhQb3NpdGlvbiA9IG9mZnNldCArIHhJZHggKiBkaW1lbnNpb247XG4gICAgY29uc3QgcmVhbFhQb3NpdGlvbiA9XG4gICAgICBuYXR1cmFsWFBvc2l0aW9uIC0gKG5hdHVyYWxYUG9zaXRpb24gPj0gd2lkdGggPyB3aWR0aCA6IDApO1xuICAgIGNvbnN0IGlzU3BsaXRDb2x1bW4gPSByZWFsWFBvc2l0aW9uID4gd2lkdGggLSBkaW1lbnNpb247XG4gICAgcmV0dXJuIHJvdy5tYXAoKHNxdWFyZSwgeUlkeCkgPT4ge1xuICAgICAgaXNTcGxpdENvbHVtblxuICAgICAgICA/IHBhaW50U3BsaXRTcXVhcmUoc3F1YXJlLCBuYXR1cmFsWFBvc2l0aW9uLCB5SWR4KVxuICAgICAgICA6IHBhaW50V2hvbGVTcXVhcmUoc3F1YXJlLCByZWFsWFBvc2l0aW9uLCB5SWR4KTtcbiAgICAgIHJldHVybiBzcXVhcmU7XG4gICAgfSk7XG4gIH0pO1xuICByZXR1cm4gc3RhdGU7XG59XG5cbmZ1bmN0aW9uIHBhaW50V2hvbGVTcXVhcmUoc3F1YXJlOiBTcXVhcmUsIHJlYWxYUG9zaXRpb246IG51bWJlciwgeUlkeDogbnVtYmVyKSB7XG4gIGNvbnN0IHsgY29sb3JJbmRleCwgb3ZlcmxheVdpZHRoIH0gPSBzcXVhcmU7XG4gIGNvbnN0IHlDb29yZCA9IHlJZHggKiBkaW1lbnNpb247XG4gIGNvbnN0IHhDb29yZCA9IHJlYWxYUG9zaXRpb24gKyBkaW1lbnNpb24gLyAyIC0gb3ZlcmxheVdpZHRoIC8gMjtcblxuICBwYWludEJhc2VTcXVhcmUocmVhbFhQb3NpdGlvbiwgeUNvb3JkLCBkaW1lbnNpb24sIGNvbG9ySW5kZXgpO1xuICBwYWludE92ZXJsYXkoXG4gICAgeENvb3JkLFxuICAgIHlDb29yZCxcbiAgICBvdmVybGF5V2lkdGgsXG4gICAgc3F1YXJlLmNvbG9ySW5kZXgsXG4gICAgc3F1YXJlLnNxdWFyZVN0YXRlXG4gICk7XG59XG5cbmZ1bmN0aW9uIHBhaW50U3BsaXRTcXVhcmUoXG4gIHNxdWFyZTogU3F1YXJlLFxuICBuYXR1cmFsWFBvc2l0aW9uOiBudW1iZXIsXG4gIHlJZHg6IG51bWJlclxuKSB7XG4gIGNvbnN0IHsgY29sb3JJbmRleCwgb3ZlcmxheVdpZHRoLCBzcXVhcmVTdGF0ZSB9ID0gc3F1YXJlO1xuICBjb25zdCB5Q29vcmQgPSB5SWR4ICogZGltZW5zaW9uO1xuICBjb25zdCBuYXR1cmFsTGVmdEVkZ2VPZk92ZXJsYXkgPSBkaW1lbnNpb24gLyAyIC0gb3ZlcmxheVdpZHRoIC8gMjtcbiAgY29uc3Qgb3ZlcmxheVJpZ2h0WENvb3JkID0gbmF0dXJhbFhQb3NpdGlvbiArIG5hdHVyYWxMZWZ0RWRnZU9mT3ZlcmxheTtcbiAgLy8gcmlnaHQgc2lkZSBvZiBzY3JlZW5cbiAgcGFpbnRCYXNlU3F1YXJlKG5hdHVyYWxYUG9zaXRpb24sIHlDb29yZCwgZGltZW5zaW9uLCBjb2xvckluZGV4KTtcbiAgcGFpbnRPdmVybGF5KFxuICAgIG92ZXJsYXlSaWdodFhDb29yZCxcbiAgICB5Q29vcmQsXG4gICAgb3ZlcmxheVdpZHRoLFxuICAgIGNvbG9ySW5kZXgsXG4gICAgc3F1YXJlU3RhdGVcbiAgKTtcblxuICAvLyBsZWZ0IHNpZGUgb2Ygc2NyZWVuXG4gIGNvbnN0IGxlZnRSZWN0V2lkdGggPSAoZGltZW5zaW9uIC0gKHdpZHRoIC0gbmF0dXJhbFhQb3NpdGlvbikpICUgd2lkdGg7XG4gIHBhaW50QmFzZVNxdWFyZSgwLCB5Q29vcmQsIGxlZnRSZWN0V2lkdGgsIGNvbG9ySW5kZXgpO1xuICBjb25zdCByaWdodFJlY3RXaWR0aCA9IGRpbWVuc2lvbiAtIGxlZnRSZWN0V2lkdGg7XG4gIGNvbnN0IGRpc3RhbmNlQmV0d2VlblJlY3RFZGdlYW5kUmlnaHRFZGdlT2ZPdmVybGF5ID1cbiAgICBkaW1lbnNpb24gLyAyIC0gb3ZlcmxheVdpZHRoIC8gMjtcbiAgY29uc3QgaXNFbnRpcmVPdmVybGF5T25MZWZ0UmVjdCA9XG4gICAgbGVmdFJlY3RXaWR0aCA+IGRpc3RhbmNlQmV0d2VlblJlY3RFZGdlYW5kUmlnaHRFZGdlT2ZPdmVybGF5O1xuICBjb25zdCBvdmVybGF5TGVmdFhDb29yZCA9IGlzRW50aXJlT3ZlcmxheU9uTGVmdFJlY3RcbiAgICA/IG5hdHVyYWxMZWZ0RWRnZU9mT3ZlcmxheSAtIHJpZ2h0UmVjdFdpZHRoXG4gICAgOiAwO1xuICBjb25zdCBvdmVybGF5TGVmdHdpZHRoID0gaXNFbnRpcmVPdmVybGF5T25MZWZ0UmVjdFxuICAgID8gb3ZlcmxheVdpZHRoXG4gICAgOiBvdmVybGF5V2lkdGggLSByaWdodFJlY3RXaWR0aDtcbiAgcGFpbnRPdmVybGF5KFxuICAgIG92ZXJsYXlMZWZ0WENvb3JkLFxuICAgIHlDb29yZCxcbiAgICBvdmVybGF5TGVmdHdpZHRoLFxuICAgIGNvbG9ySW5kZXgsXG4gICAgc3F1YXJlU3RhdGVcbiAgKTtcbn1cblxuZnVuY3Rpb24gcGFpbnRPdmVybGF5KFxuICB4Q29vcmQ6IG51bWJlcixcbiAgeUNvb3JkOiBudW1iZXIsXG4gIHdpZHRoOiBudW1iZXIsXG4gIGNvbG9ySW5kZXg6IG51bWJlcixcbiAgc3F1YXJlU3RhdGU6IFNxdWFyZVN0YXRlXG4pIHtcbiAgY3R4Lmdsb2JhbEFscGhhID0gMC45NTtcbiAgY3R4LmZpbGxTdHlsZSA9IGdldE92ZXJsYXlDb2xvcihjb2xvckluZGV4LCBzcXVhcmVTdGF0ZSk7XG4gIGN0eC5maWxsUmVjdCh4Q29vcmQsIHlDb29yZCwgd2lkdGgsIGRpbWVuc2lvbik7XG59XG5cbmZ1bmN0aW9uIHBhaW50QmFzZVNxdWFyZShcbiAgeENvb3JkOiBudW1iZXIsXG4gIHlDb29yZDogbnVtYmVyLFxuICB3aWR0aDogbnVtYmVyLFxuICBjb2xvckluZGV4OiBudW1iZXJcbikge1xuICBjdHguZ2xvYmFsQWxwaGEgPSAxO1xuICBjdHguZmlsbFN0eWxlID0gZ2V0QmFzZUNvbG9yKGNvbG9ySW5kZXgpO1xuICBjdHguZmlsbFJlY3QoeENvb3JkLCB5Q29vcmQsIHdpZHRoLCBkaW1lbnNpb24pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc3RhcnRTcXVhcmVBbmltYXRpb24oKTogdm9pZCB7XG4gIGNvbnN0IHN0YXRlID0gZ2V0R2xvYmFsU3RhdGUoKTtcbiAgZnVuY3Rpb24gcmVjdXJzaXZlbHlBbmltYXRlU3F1YXJlcygpOiB2b2lkIHtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHBhaW50KHN0YXRlKTtcbiAgICAgIG1vdmVTcXVhcmVzKHN0YXRlKTtcbiAgICAgIHJlY3Vyc2l2ZWx5QW5pbWF0ZVNxdWFyZXMoKTtcbiAgICB9LCBpbnRlcnZhbCk7XG4gIH1cblxuICByZWN1cnNpdmVseUFuaW1hdGVTcXVhcmVzKCk7XG59XG5cbmZ1bmN0aW9uIGdldE92ZXJsYXlDb2xvcihcbiAgY29sb3JJbmRleDogbnVtYmVyLFxuICBzcXVhcmVTdGF0ZTogU3F1YXJlU3RhdGVcbik6IE92ZXJsYXlDb2xvciB7XG4gIHJldHVybiBnZXRPdmVybGF5UGFsZXR0ZShzcXVhcmVTdGF0ZSwgY29sb3JJbmRleCk7XG59XG4iLCJpbXBvcnQgeyBTcXVhcmVTdGF0ZSB9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHsgaGFzTGlnaHRQcmltYXJ5UGFsZXR0ZSB9IGZyb20gJy4vc3F1YXJlJztcblxuY29uc3QgYmFzZUNvbG9ycyA9IE9iamVjdC5mcmVlemUoWycjRUFFOEUzJywgJyNDOUMzQzEnLCAnI0MyQzFDOScsICcjRkZGQ0YyJ10pO1xuY29uc3QgbGlnaHRDb2xvcnMgPSBPYmplY3QuZnJlZXplKFsnI0VBRTBDQycsICcjQzlBREExJywgJyNBREE3QzknLCAnI0ZGRjNCQiddKTtcbmNvbnN0IGRhcmtDb2xvcnMgPSBPYmplY3QuZnJlZXplKFsnIzg0Nzc1RScsICcjN0MzQTJBJywgJyM0OTJBOTEnLCAnI0Q4QzE1OCddKTtcblxuZXhwb3J0IHR5cGUgT3ZlcmxheUNvbG9yID1cbiAgfCB0eXBlb2YgYmFzZUNvbG9yc1tudW1iZXJdXG4gIHwgdHlwZW9mIGxpZ2h0Q29sb3JzW251bWJlcl07XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRPdmVybGF5UGFsZXR0ZShcbiAgc3F1YXJlU3RhdGU6IFNxdWFyZVN0YXRlLFxuICBjb2xvckluZGV4OiBudW1iZXJcbikge1xuICByZXR1cm4gKGhhc0xpZ2h0UHJpbWFyeVBhbGV0dGUoc3F1YXJlU3RhdGUpID8gbGlnaHRDb2xvcnMgOiBkYXJrQ29sb3JzKVtcbiAgICBjb2xvckluZGV4XG4gIF07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRCYXNlQ29sb3IoaW5kZXg6IG51bWJlcikge1xuICByZXR1cm4gYmFzZUNvbG9yc1tpbmRleF07XG59XG4iXSwic291cmNlUm9vdCI6IiJ9